<!doctype html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-105607174-2"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-105607174-2');
    </script>
    <title>Caleb Kruse - Microcolor</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- css. Last sheet takes priority -->
    <link rel="stylesheet" href="/css/style-v2.css">
    <link rel="stylesheet" href="/css/header-backgrounds.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
</head>

<body>

    <header class="proto-microcolor">
        <div class="container-fluid menu">
            <div class="d-flex justify-content-end">
                <a href="/">
                    <button class="button-white">home</button>
                </a>
            </div>
        </div>
    </header>


    <div class="article">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 col-md-10 col-xs-12">
                    <h3 class="article-heading-blue mt-5">10 projects - #9</h3>
                    <h3 class="article-heading-blue mb-0">microcolor</h3>
                    <h5 class="article-heading-black mt-0">training a neural network to colorize microscopy images</h5>

                    <h5>project goal</h5>
                    <p>
                        Most microscopy is either in black and white, or the color saturation of the image is very low.
                        It's even impossible for electron microscopy to image a subject in color, as it only reads a
                        grayscale intensity. Color versions of electron microscope images exist, color is added by hand.
                        My goal was to find a way to automatically colorize microscope imagery.
                    </p>

                    <h5>methods</h5>
                    <p>
                        Neural networks have shown great promise in converting black and white images to color. In
                        particular, the <a href="https://github.com/jantic/DeOldify#example-images">DeOldify</a> network
                        can produce outstanding results for typical photo imagery. I had used this network in the past
                        to colorize microscope images. Occasionally I had success, but frequently the network assigned
                        the image a drab greenish yellow or wouldn't colorize at all. I assume that this is because
                        microscopy is far outside the trained domain of the network. This gave me hope that networks
                        could do a good job at colorization if I had the right dataset.
                    </p>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row justify-content-center">
                <div class="col-md-5 col-sm-10">
                    <img src="Misc_pollen - DeOldified.jpg">
                    <p class="caption">An example of an image that DeOldify colorizes well.</p>
                </div>
                <div class="col-md-5 col-sm-10">
                    <img src="butterfly-bad-color.jpg">
                    <p class="caption">An example of an image that DeOldify hardly colorizes at all.</p>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 col-md-10 col-xs-12">
                    <p>
                        For my training dataset, I used almost 2500 images from 45 years of prizewinning photos from the
                        <a href="nikonsmallworld.com/">Nikon's Small World photo competition</a>. Each of these images
                        is typically beautifully colorized, or captures a vibrant microscopic scene. Each of these
                        images could then be converted to grayscale in order to provide an input to correspond to the
                        target color counterpart.
                    </p>
                    <p>
                        I attempted to retrain DeOldify, but the system is quite complex/finicky, and I was never able
                        to get good results. Instead I trained a <a
                            href="https://phillipi.github.io/pix2pix/">Pix2Pix</a> image translation network. This
                        network is GAN that takes an input and seeks to transform it a form that is indistinguishable
                        from a target image. In my case, the black and white image would be transformed to color. The
                        task of colorization is well within the network's capacity, and it started generating plausible
                        results fairly rapidly (within 30 epochs).
                    </p>
                    <h5>results</h5>
                    <p>
                        Perceptually, the network does an excellent job of colorization, even with minimal training.
                    </p>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row justify-content-center">
                <div class="col-md-5 col-sm-10">
                    <img src="./compilations/Compilation_583.png">
                    <p class="caption">Examples of image colorization. Input image on the right, original image in the
                        center, network output on the right.</p>
                </div>
                <div class="col-md-5 col-sm-10">
                    <img src="./compilations/Compilation_338.png">
                    <p class="caption">Examples of image colorization. Input image on the right, original image in the
                        center, network output on the right.</p>
                </div>
                <div class="col-md-5 col-sm-10">
                    <img src="./compilations/Compilation_55.png">
                    <p class="caption">Examples of image colorization. Input image on the right, original image in the
                        center, network output on the right.</p>
                </div>
                <div class="col-md-5 col-sm-10">
                    <img src="./compilations/Compilation_475.png">
                    <p class="caption">Examples of image colorization. Input image on the right, original image in the
                        center, network output on the right.</p>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 col-md-10 col-xs-12">
                    <h5>conclusion</h5>
                    <p>
                        I'm quite pleased with the outputs, particularly for the short amount of training time. I find
                        it especially fascinating when the network colors the image in a way that is different from the
                        original, but perceptually more beautiful.
                    </p>

                    <h5>what would i do next</h5>
                    <ul>
                        <li>
                            Train the network for longer.
                        </li>
                        <li>
                            The network currently only accepts square inputs. I'd like to implement a strategy to
                            accept/output arbitrary input shapes.
                        </li>
                        <li>
                            The network would almost certainly perform better if inputs/outputs were in Lab colorspace
                            rather than RGB since the color channels are separate from luminance.
                        </li>
                        <li>
                            Test whether the network could be trained to classify cell types by colorization.
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    </div>

    <footer id="footer" class="footer">
        <div class="row align-items-center">
            <div class="col-xs-12 col-6">
                <div class="footer-socials text-left">
                    <a href="https://twitter.com/clkruse" target="_blank">
                        <i class="fa fa-twitter"></i>
                    </a>
                    <a href="https://www.instagram.com/clkruse" target="_blank">
                        <i class="fa fa-instagram"></i>
                    </a>
                </div>
            </div>
            <div class="col-xs-12 col-6">
                <p class="copyright">Â© Caleb Kruse</p>
            </div>
        </div>
    </footer>
</body>

</html>