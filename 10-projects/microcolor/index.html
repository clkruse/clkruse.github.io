<!doctype html>
<html lang="en">

<head>
  <meta name="This is Caleb Kruse's portfolio site: a place to build, show, and save projects">
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-105607174-2"></script>
	<script>
		window.dataLayer = window.dataLayer || [];

		function gtag() {
			dataLayer.push(arguments);
		}
		gtag('js', new Date());

		gtag('config', 'UA-105607174-2');
	</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Microcolor - 10 Projects</title>
  <meta property="og:image" content="index-img.jpg" />

  <link rel="stylesheet" href="../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../css/font-awesome.min.css">
  <link rel="stylesheet" href="../../css/magnific-popup.css">
  <link rel="stylesheet" href="../../css/animsition.min.css">
  <link rel="stylesheet" href="../../css/animate.css">
  <link rel="stylesheet" href="../../css/pe-icon-7-stroke.css">
  <link rel="stylesheet" href="../../css/jquery.fancybox.min.css">
  <link rel="stylesheet" href="../../css/swiper3.css">
  <link rel="stylesheet" href="../../css/simple-line-icons.css">
  <link rel="stylesheet" href="../../css/ionicons.min.css">
  <link rel="stylesheet" href="../../css/slick.css">
  <link rel="stylesheet" href="../../css/style.min.css">
  <link rel="stylesheet" href="../../css/menu.css">
  <link rel="stylesheet" href="../../css/style-child-theme.min.css">
  <link rel="stylesheet" href="../../css/video_banner.min.css">
  <link rel="stylesheet" href="../../css/lightgallery.min.css">
</head>

<body>
  <!-- MAIN_WRAPPER -->
  <div class="main-wrapper" data-top="992">
    <div class="header_top_bg  header_trans-fixed menu_dark_text" style="padding-bottom: 0;">
      <div class="container-fluid">
        <div class="row">
          <div class="col-xs-12">
            <!-- HEADER -->
            <header class="right-menu left ">
              <!-- MOB MENU ICON -->
              <a href="#" class="mob-nav">
                <div class="hamburger">
                  <span class="line"></span>
                  <span class="line"></span>
                  <span class="line"></span>
                </div>
              </a>

              <!-- NAVIGATION -->
              <nav id="topmenu" class="topmenu ">
                <a href="#" class="mob-nav-close">
                  <span>close</span>
                  <div class="hamburger">
                    <span class="line"></span>
                    <span class="line"></span>
                  </div>
                </a>
                <ul class="menu">
                  <li class="menu-item">
                    <a href="http://calebkruse.com/">home</a>
                  </li>
                  <li id="menu-item-9" class="menu-item menu-item-has-children">
                    <a href="#">topics</a>
                    <ul class="sub-menu">
                      <li class="menu-item">
                        <a href="http://calebkruse.com/ng">National Geographic</a></li>
                      <li class="menu-item">
                        <a href="http://calebkruse.com/ml">Machine Learning</a></li>
                      <li class="menu-item">
                        <a href="http://calebkruse.com/sci">Science</a></li>
                      <li class="menu-item">
                        <a href="http://calebkruse.com/xr">AR/VR</a></li>
                      <li class="menu-item">
                        <a href="http://calebkruse.com/photo">Photography</a></li>
                      <li class="menu-item">
                        <a href="http://calebkruse.com/balloon.html">Balloons</a></li>
                      <li class="menu-item">
                        <a href="http://calebkruse.com/maps.html">Maps</a></li>
                      <li class="menu-item">
                        <a href="http://calebkruse.com/10-projects">Prototypes</a></li>
                    </ul>
                  </li>
                </ul>

              </nav>
            </header>
          </div>
        </div>
      </div>
    </div>


    <div class="container-fluid">
      <div class="hero">
        <div class="row bg_img_microscope">
          <div class="container">
            <div class="row">
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row margin-lg-100t margin-md-80t margin-sm-40t margin-xs-30t margin-lg-80b margin-md-55b margin-sm-40b margin-xs-20b">
        <div class="col-xs-12 col-md-offset-1 col-md-10">
          <h1 style="color:#4384d9">10 projects - #9</h1>
          <h1 style="color:#4384d9">microcolor</h1>
          <h3 class="title" style="color:#222222">training a neural network to colorize microscopy images</h3>
        </div>

      </div>
    </div>

    <div class="container">
      <div class="row margin-xs-20b margin-md-20b margin-lg-40b">
        <div class="col-md-offset-1 col-md-11">

          <div class="text">
            <h5 class="subtitle">project goal</h5>
            <p>
              Most microscopy is either in black and white, or the color saturation of the image is very low. It's even impossible for electron microscopy to image a subject in color, as it only reads a grayscale intensity. Color versions of electron microscope images exist, color is added by hand. My goal was to find a way to automatically colorize microscope imagery.
            </p>
          </div>
        </div>
      </div>


      <div class="row margin-xs-20b margin-md-20b margin-lg-40b">
        <div class="col-md-offset-1 col-md-11">
          <div class="text">
            <h5 class="subtitle">methods</h5>
            <p>
              Neural networks have shown great promise in converting black and white images to color. In particular, the <a href="https://github.com/jantic/DeOldify#example-images">DeOldify</a> network can produce outstanding results for typical photo imagery. I had used this network in the past to colorize microscope images. Occasionally I had success, but frequently the network assigned the image a drab greenish yellow or wouldn't colorize at all. I assume that this is because microscopy is far outside the trained domain of the network. This gave me hope that networks could do a good job at colorization if I had the right dataset.
            </p>
            <div class="row">
              <div class="col-md-6">
                <img src="Misc_pollen - DeOldified.jpg">
                <p class="subtext">An example of an image that DeOldify colorizes well.</p>
              </div>
              <div class="col-md-6 right">
                <img src="butterfly-bad-color.jpg">
                <p class="subtext">An example of an image that DeOldify hardly colorizes at all.</p>
              </div>
            </div>
            <p>
              For my training dataset, I used almost 2500 images from 45 years of prizewinning photos from the <a href="nikonsmallworld.com/">Nikon's Small World photo competition</a>. Each of these images is typically beautifully colorized, or captures a vibrant microscopic scene. Each of these images could then be converted to grayscale in order to provide an input to correspond to the target color counterpart.
            </p>
            <p>
              I attempted to retrain DeOldify, but the system is quite complex/finicky, and I was never able to get good results. Instead I trained a <a href="https://phillipi.github.io/pix2pix/">Pix2Pix</a> image translation network. This network is GAN that takes an input and seeks to transform it a form that is indistinguishable from a target image. In my case, the black and white image would be transformed to color. The task of colorization is well within the network's capacity, and it started generating plausible results fairly rapidly (within 30 epochs).
            </p>
          </div>
        </div>
      </div>

      <div class="row margin-xs-20b margin-md-20b margin-lg-40b">
        <div class="col-md-offset-1 col-md-11">
          <div class="text">
            <h5 class="subtitle">results</h5>
            <p>
              Perceptually, the network does an excellent job of colorization, even with minimal training.
            </p>
            <div class="row">
              <div class="col-md-6">
                <img src="compilations/Compilation_583.png"/>
                <p class="subtext">Examples of image colorization. Input image on the right, original image in the center, network output on the right.</p>
              </div>
              <div class="col-md-6 right">
                <img src="compilations/Compilation_338.png"/>
                <p class="subtext">Examples of image colorization. Input image on the right, original image in the center, network output on the right.</p>
              </div>

            </div>
            </br>
            <p>
              Here are additional examples:
            </p>
            <div class="row">
              <div class="col-md-6">
                <img src="compilations/Compilation_55.png"/>
                <p class="subtext">Examples of image colorization. Input image on the right, original image in the center, network output on the right.</p>
              </div>
              <div class="col-md-6 right">
                <img src="compilations/Compilation_475.png"/>
                <p class="subtext">Examples of image colorization. Input image on the right, original image in the center, network output on the right.</p>
              </div>

            </div>
          </div>
        </div>
      </div>

      <div class="row margin-xs-20b margin-md-20b margin-lg-40b">
        <div class="col-md-offset-1 col-md-11">
          <div class="text">
            <h5 class="subtitle">conclusion</h5>
            <p>
              I'm quite pleased with the outputs, particularly for the short amount of training time. I find it especially fascinating when the network colors the image in a way that is different from the original, but perceptually more beautiful.
            </p>
            </br>
          </div>
        </div>
      </div>
      <div class="row margin-xs-20b margin-md-20b margin-lg-40b">
        <div class="col-md-offset-1 col-md-11">
          <div class="text">
            <h5 class="subtitle">what will i do next</h5>
            <ul>
              <li>
                Train the network for longer
              </li>
              <li>
                Create a better test dataset
              </li>
              <li>
                Test whether the network could be trained to classify cell types by colorization
              </li>
            </ul>
            </br>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer id="footer" class="modern">
    <div class="container no-padd">

      <div class="col-xs-12 footer-socials text-left col-sm-6">
        <a href="https://twitter.com/clkruse" target="_blank">
          <i class="fa fa-twitter"></i>
        </a>
        <a href="https://www.instagram.com/clkruse" target="_blank">
          <i class="fa fa-instagram"></i>
        </a>
      </div>

      <div class="copyright col-xs-12 text-right col-sm-6">
        © Caleb Kruse
      </div>

    </div>
  </footer>

  <script src="../../js/jquery.min.js"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
  <script src="../../js/lib/modernizr-2.6.2.min.js"></script>
  <script src="../../js/lib/scripts.js"></script>
  <script src="../../js/jquery.countdown.min.js"></script>
  <script src="../../js/foxlazy.js"></script>
  <script src="../../js/jquery.easings.min.js"></script>
  <script src="../../js/jquery.multiscroll.min.js"></script>
  <script src="../../js/magnific.js"></script>
  <script src="../../js/TweenMax.min.js"></script>
  <script src="../../js/equalHeightsPlugin.js"></script>
  <script src="../../js/jquery.fancybox.min.js"></script>
  <script src="../../js/jquery.fitvids.js"></script>
  <script src="../../js/swiper3.js"></script>
  <script src="../../js/imagesloaded.pkgd.min.js"></script>
  <script src="../../js/fragment.js"></script>
  <script src="../../js/scrollMonitor.js"></script>
  <script src="../../js/slider-transition.js"></script>
  <script src="../../js/slick.js"></script>
  <script src="../../js/jquery.sliphover.min.js"></script>
  <script src="../../js/pixi.min.js"></script>
  <script src="../../js/lightgallery.min.js"></script>
  <script src="../../js/lib/thumbnails-popup.js"></script>
  <script src="../../js/script.js"></script>

</body>

</html>
