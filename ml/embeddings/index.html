<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0" />
  <title>What Do Embedding Models See?</title>
  <meta name="description"
    content="Explore how the CLIP and DINO models classify and organize the world through interactive experiments." />

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://calebkruse.com/ml/embeddings/" />
  <meta property="og:title" content="What Do Embedding Models See?" />
  <meta property="og:description"
    content="Explore how the CLIP and DINO models classify and organize the world through interactive experiments." />
  <meta property="og:image" content="https://calebkruse.com/ml/embeddings/preview.png" />

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content="https://calebkruse.com/ml/embeddings/" />
  <meta property="twitter:title" content="What Do Embedding Models See?" />
  <meta property="twitter:description"
    content="Explore how the CLIP and DINO models classify and organize the world through interactive experiments." />
  <meta property="twitter:image" content="https://calebkruse.com/ml/embeddings/preview.png" />

  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <a class="home-link" href="https://calebkruse.com/" target="_self" rel="noopener">home</a>
  <header class="pixel-header">
    
    <h1 class="pixel-title">What do Embedding Models See?</h1>
    <div class="pixel-tagline">Exploring how the CLIP and DINO models classify and organize the world</div>
  </header>
  <div class="main-grid">
    <div class="left-scroll">
      <section class="content-section">
        <p>
          We’re going to explore a bit about how AIs see, organize, and make sense of the visual world by doing a few
          interactive experiments.
        </p>
      </section>
      <section class="content-section" id="text-dewey">
        <h2 class="section-title">Organizing the World</h2>
        <p>
          To be able to understand the world, vision models need to convert an image into a language that they
          understand. For an AI model, that means a list of numbers. These numbers work a bit like the Dewey Decimal
          System at the library. Books are assigned a number based on their topic, and similar topics have shared
          numerical values. This means that all cookbooks start with numbers in the 640s, and astronomy books are listed
          in the 520s.
        </p>
        <p>
          It’s very important that these numbers are well structured. Suppose that every book in the library were
          assigned a random number and laid out on the shelves in numerical order. Instead of finding a group of books
          of a similar topic on one shelf, you’d have to hunt through the entire library searching for books on one
          topic of interest.
        </p>
        <p>
          AI models need to act as librarians. They take in images and organize them by transforming each one into a
          list of numbers. As with the library, images containing similar content should have numbers that are closer in
          value to each other. This list of numbers is called an “embedding vector”, or an “embedding” for short.
        </p>
        <div id="inline-fig-dewey" class="inline-figure"></div>
      </section>
      <section id="text-embedding" class="content-section">
        <h2 class="section-title">Embedding Models</h2>
        <p>
          AI models create these powerful embeddings to organize the world, but they don't reveal how they are
          structured or what they can see. We're going to explore this!
        </p>
        <p>
          Of course we should be curious about how an AI sees the world, but it also is very important to determine the
          model's capabilities. We'd like to know where these models are sensitive, and where they are blind. What
          things do AI models see as similar, and what do they consider to be very far apart?
        </p>
        <p>
          We're going to evaluate this through a set of explorations. Each exploration gives an AI model two inputs and
          asks "how similar do you think these are?"
        </p>
        <div id="inline-fig-embedding" class="inline-figure"></div>
      </section>
      <section id="text-cosine" class="content-section">
        <h2 class="section-title">Measuring Similarity</h2>
        <p>
          Given that embedding vectors have many hundreds of values, how can we measure how similar one is to another?
          We have a nice technique called cosine similarity. Here’s how it works.
        </p>
        <p>
          We’ll first treat the list of numbers in an embedding vector as coordinates of a point in a space. Each number
          describes a position along a different axis. To make it simple, we’ll start with an embedding that has only
          two dimensions.
        </p>
        <p>
          In our example, we’ll give the first embedding vector the values 3 and 1, and the second 1 and 2. We’ll label
          these positions on the graph by setting the blue point to <button class="config-button"
            onclick="window.setVectorPositions(3, 1, null, null)">position [3, 1]</button>, and the green point to
          <button class="config-button" onclick="window.setVectorPositions(null, null, 1, 2)">position [1, 2]</button>.
        </p>
        <div id="inline-fig-cosine" class="inline-figure"></div>
        <p>
          You’ll notice that we can draw the angle between the lines that extend from the origin of the graph to the
          points. In this case, that angle is 45˚. This angle indicates how similar the points are to one another. A
          smaller angle indicates that the two points are similar, whereas a larger angle indicates that they’re further
          apart. This is our similarity score.

        </p>
        <p>
          To make this number nicer to work with, we’ll take the cosine of this angle. We do this to convert the angle
          to a scale between -1 and 1. This is the cosine similarity score between two embeddings. You can see this
          score in blue above the plot.
        </p>
        <p>
          Drag the points around to see how the score changes. A cosine similarity value close to 1 indicates that the
          points are nearly the same, 0 means they’re perpendicular, and -1 means that they’re pointing in exactly
          opposite directions.
        </p>
        <p>
          This technique that works simply in two dimensions translates very well to higher dimensionalities, and is
          what we’ll use to compare embeddings created by AI models.
        </p>
        <div class="sidebar-note">
          You might say "well, an angle isn't a very good measurement because even if two points can be on the same
          line, one might extend further than the other." You are right, but this problem disappears as you go to higher
          dimensions. You'll have to trust me on this one.
        </div>

      </section>
      <section id="text-compare" class="content-section">
        <h2 class="section-title">Image Similarity</h2>
        <p>
          How can we examine how these embedding models see the world? Given that the embeddings themselves are mostly inscrutable, we’ll look instead at the similarity of embeddings produced for two different images. Through this process, we’ll build an intuition for how a model sees.
        </p>
        <p>
          For each experiment, we're going to use two popular embedding models. One is called CLIP and the other is called DINO. In each test, these models will compute embeddings for the images on the left and right, and then measure the similarity of these two embedding representations. The similarity scores for each of the models will be shown in the scoreboard above the images.
        </p>
        <p>
          We'll start by comparing <button class="config-button"
            onclick="window.setCompareImages('Animals', 'Gray Parrot', 'Gray Parrot 2')">two images of a gray
            parrot</button>. As you'd expect, the similarity score is very high. The CLIP model gives it a score of
          0.92 and the DINO model gives it a score of 0.95.  Even though the images are a little different, the models see them as similar.
        </p>
        <div id="inline-fig-compare" class="inline-figure"></div>
        <p>
          Now let's see what happens when we look at a <button class="config-button"
            onclick="window.setCompareImages('Animals', 'Gray Parrot', 'Gray Parrot Full')">another gray
            parrot</button>. Once again, the scores are still quite high, but a little lower than before. Everything is
          behaving as we'd expect.
        </p>
        <p>
          Now let's try a few more experiments. Let's compare <button class="config-button"
            onclick="window.setCompareImages('Animals', 'Beagle', 'Vizsla')">two floppy-eared breeds of dogs</button>.
          The CLIP model thinks that they are even more similar than the two gray parrots, but the DINO model thinks
          that they are quite far apart. This is interesting! It means that the CLIP model groups them together as dogs,
          but the DINO model thinks that they are significantly different.
        </p>
        <p>
          Make some comparisons of your own. You might try comparing a <button class="config-button"
            onclick="window.setCompareImages('Animals', 'Leopard', 'Lynx')">leopard to a lynx</button>, a <button
            class="config-button" onclick="window.setCompareImages('Animals', 'Raccoon', 'Chihuahua')">racoon to a
            chihuahua</button>, or a <button class="config-button"
            onclick="window.setCompareImages('Animals', 'Red Squirrel', 'Beaver')">squirrel to a beaver</button>.
        </p>
        <p>
          In doing these tests, we can start to build up intuition for how the models perceive the images. It seems like
          the DINO model is more sensitive to differences in images, while the CLIP model might group at a more
          conceptual level. CLIP might be saying something like "these are all animals to me", whereas DINO is saying
          "this dog looks nothing like that other dog!" Both are equally correct, but it gives a clue toward how these
          models represent the world.
        </p>
      </section>
      <section id="text-rot" class="content-section" aria-label="Rotation description">
        <h2 class="section-title">Rotation</h2>
        <p>Now that we’ve looked at the similarity between different images, let’s see what happens if we transform the same image. We’ll start by looking at rotation. As a human, you’d likely say that a rotated image is similar to the original, but a little different. Do the models say the same?</p>
        <p>
          We’ll start with a <button class="config-button" onclick="window.setRotationExample(180, 'butterfly')">butterfly rotated 180˚</button>. You can see that CLIP finds that the two images are highly similar (0.98), while DINO sees them further apart (0.91).
        </p>
        <div id="inline-fig-rot" class="inline-figure"></div>
        <p>
          The chart on the bottom shows how the similarity score changes as a function of angle. You can see that the DINO model thinks the images are most different when <button class="config-button" onclick="window.setRotationExample(235, 'butterfly')">one is rotated by 235˚</button>.
        </p>
        <p>
          A butterfly is a concrete semantic target. With a minimum similarity score of 0.975, it seems that CLIP consistently puts it into the same “butterfly” region of embedding space. 
        </p>
        <p>
          But let’s take a look at a different type of image. We’ll use a <button class="config-button" onclick="window.setRotationExample(180, 'island')">satellite image of an island</button>. This is a less-concrete target, and one without a notion of “proper” orientation.
        </p>
        <p>
          Now the CLIP model starts behaving more like what we’ve seen from the DINO model. It becomes more sensitive to rotations and finds <button class="config-button" onclick="window.setRotationExample(240, 'island')">certain orientations</button> to be highly dissimilar.
        </p>
        <p>
          Explore some of the other images. You might see periodic similarities with <button class="config-button" onclick="window.setRotationExample(135, 'checkerboard')">a checkerboard</button>, a stronger reaction to uncommon scenarios when looking at an <button class="config-button" onclick="window.setRotationExample(180, 'elk')">upside-down elk</button>, or a puzzling plot when looking at an <button class="config-button" onclick="window.setRotationExample(290, 'airport')">aerial view of an airport</button>.
        </p>
      </section>
      <section id="text-3d" class="content-section" aria-label="3D rotation description">
        <h2 class="section-title">3D Rotation</h2>
        <p>
          Turning an image upside-down and seeing how the models respond is interesting, but not always realistic. After all, does it matter what a model thinks of an upside-down elk? It would be more informative if we could view the same object from a different perspective and see what the models think.
        </p>
        <p>
          We'll do exactly this by rendering a 3D model from different perspectives and comparing the similarity of the embeddings. We’ll start with a <button class="config-button" onclick="window.set3DExample('cow', 0, 180)">simple model of a cow</button>.
        </p>
        <div id="inline-fig-3d" class="inline-figure"></div>
        <p>
          These rotation plots are more complex to analyze. We see that for a <button class="config-button" onclick="window.set3DExample('Skull', 0, 235)">model of a skull</button>, the CLIP model maintains fairly high similarity, whereas DINO similarity abruptly drops off as soon as the back of the head dominates the frame. Or how the models see geography when looking at a <button class="config-button" onclick="window.set3DExample('Earth', 235, 270)">model of the globe</button>.
        </p>
      </section>
      
      <section id="text-color" class="content-section" aria-label="Color description">
        <h2 class="section-title">Color</h2>
        <p>
          Lastly, we’ll look at transforming the color of the image to understand whether color is an important feature to these models. 
        <p>
          We’ll start by changing the color of an egg yolk. Though in most other cases the DINO model was much more sensitive than CLIP, the roles are reversed here. The DINO model finds all colors to be fairly similar, whereas the CLIP model has significantly more variation.
        </p>
        <div id="inline-fig-color" class="inline-figure"></div>
        <p>
          The same pattern holds when looking at a <button class="config-button" onclick="window.setColorExample('Car', 0, 18)">car in different colors</button>. It’s quite interesting to see which color combinations CLIP finds to be most dissimilar.
        </p>
      </section>
      <section id="text-conclusion" class="content-section" aria-label="Conclusion">
        <h2 class="section-title">Conclusions</h2>
        <p>
          Generally, it seems as if CLIP is more semantic as it groups similar concepts together a little more tightly. This is in contrast to DINO, which seems to look at the images more literally. Most of these results make sense when you look at how the models were trained. DINO with purely image-based training, and CLIP with a training objective to align text and image spaces. Neither approach is necessarily better, but they can have different strengths.
        </p>
        <p>
          Similarity is a very crude metric for evaluating these incredibly rich embedding vectors, but it gives a glimpse at how the models organize the world by placing images within their embedding spaces. By playing with these examples I have a better intuition for how these models behave and I hope you do too.
        </p>
        <div class="sidebar-note">
          If you liked this, you might enjoy reading about why <a href="https://calebkruse.com/10-projects/seeing-blue/">we're blind to seeing the color blue</a>. Or <a href="https://x.com/clkruse" target="_blank" rel="noopener">follow on twitter</a> for more occasional explorations.
        </div>
      </section>
    </div>
    <div class="container">

      <div id="right-panel" class="right-panel">
        <section id="sec-compare" class="content-section">
          <div class="viewer viewer-slim">
            <div class="metrics-row">
              <div class="selector-group">
                <label for="datasetSelect-compare" class="muted small-label">Dataset</label>
                <select id="datasetSelect-compare" aria-label="Dataset selector"></select>
              </div>
              <div class="metric-group align-right">
                <span class="muted small-label">CLIP</span>
                <span id="clipValue-compare" class="metric metric-clip">—</span>
                <span class="spacer"></span>
                <span class="muted small-label">DINO</span>
                <span id="dinoValue-compare" class="metric metric-dino">—</span>
              </div>
            </div>
          </div>

          <div class="viewers" style="overflow: hidden;">
            <div class="viewer">
              <div class="image-frame">
                <img id="img-compare-1" alt="Compare Image 1" loading="lazy" />
              </div>
              <div class="selector-group">
                <select id="imageSelect-compare-1" aria-label="Image 1 selector" class="image-dropdown"></select>
              </div>
            </div>

            <div class="viewer">
              <div class="image-frame">
                <img id="img-compare-2" alt="Compare Image 2" loading="lazy" />
              </div>
              <div class="selector-group">
                <select id="imageSelect-compare-2" aria-label="Image 2 selector" class="image-dropdown"></select>
              </div>
            </div>
          </div>
        </section>
        <section id="sec-cosine" class="content-section">
          <div class="viewer viewer-slim">
            <div class="metrics-row">
              <div class="selector-group">
                <span class="muted small-label">Cosine Similarity</span>
              </div>
              <div class="metric-group align-right">
                <span id="cosine-similarity-value" class="metric cosine-metric">1.000</span>
              </div>
            </div>
          </div>

          <div class="viewer plot-card">
            <div id="vector-plot-container" class="vector-plot-container"></div>
          </div>
        </section>
        <section id="sec-3d" class="content-section">
          <div class="viewer viewer-slim">
            <div class="metrics-row">
              <div class="selector-group">
                <label for="modelSelect-3d" class="muted small-label">Model</label>
                <select id="modelSelect-3d" aria-label="3D model selector"></select>
              </div>
              <div class="metric-group align-right">
                <span class="muted small-label">CLIP</span>
                <span id="clipValue-3d" class="metric metric-clip">—</span>
                <span class="spacer"></span>
                <span class="muted small-label">DINO</span>
                <span id="dinoValue-3d" class="metric metric-dino">—</span>
              </div>
            </div>
          </div>

          <div class="viewers" style="overflow: hidden;">
            <div class="viewer">
              <div class="image-frame">
                <img id="img-3d-1" alt="3D View 1" loading="lazy" />
              </div>
              <div class="slider-row">
                <input id="slider-3d-1" type="range" min="0" max="360" step="5" value="0"
                  aria-label="3D angle slider 1" />
                <div class="angle-label" id="angle-3d-1">0°</div>
              </div>
            </div>

            <div class="viewer">
              <div class="image-frame">
                <img id="img-3d-2" alt="3D View 2" loading="lazy" />
              </div>
              <div class="slider-row">
                <input id="slider-3d-2" type="range" min="0" max="360" step="5" value="0"
                  aria-label="3D angle slider 2" />
                <div class="angle-label" id="angle-3d-2">0°</div>
              </div>
            </div>
          </div>
          <div class="viewer plot-card">
            <div class="metrics-row">
              <div class="selector-group">
                <span class="small-label muted">Similarity vs angle</span>
              </div>
              <div class="metric-group align-right small-legend">
                <span class="legend legend-clip"></span>
                <span class="small-label">CLIP</span>
                <span class="spacer"></span>
                <span class="legend legend-dino"></span>
                <span class="small-label">DINO</span>
              </div>
            </div>
            <div id="plot-3d" class="plot"></div>
          </div>
        </section>

        <section id="sec-rot" class="content-section">
          <div class="viewer viewer-slim">
            <div class="metrics-row">
              <div class="selector-group">
                <label for="modelSelect-rot" class="muted small-label">Model</label>
                <select id="modelSelect-rot" aria-label="Rotation model selector"></select>
              </div>
              <div class="metric-group align-right">
                <span class="muted small-label">CLIP</span>
                <span id="clipValue-rot" class="metric metric-clip">—</span>
                <span class="spacer"></span>
                <span class="muted small-label">DINO</span>
                <span id="dinoValue-rot" class="metric metric-dino">—</span>
              </div>
            </div>
          </div>

          <div class="viewers" style="overflow: hidden;">
            <div class="viewer">
              <div class="image-frame">
                <img id="img-rot-1" alt="Rotation View 1" loading="lazy" />
              </div>
              <div class="slider-row">
                <input id="slider-rot-1" type="range" min="0" max="360" step="5" value="0"
                  aria-label="Rotation angle slider 1" />
                <div class="angle-label" id="angle-rot-1">0°</div>
              </div>
            </div>

            <div class="viewer">
              <div class="image-frame">
                <img id="img-rot-2" alt="Rotation View 2" loading="lazy" />
              </div>
              <div class="slider-row">
                <input id="slider-rot-2" type="range" min="0" max="360" step="5" value="0"
                  aria-label="Rotation angle slider 2" />
                <div class="angle-label" id="angle-rot-2">0°</div>
              </div>
            </div>
          </div>
          <div class="viewer plot-card">
            <div class="metrics-row">
              <div class="selector-group">
                <span class="small-label muted">Similarity vs angle</span>
              </div>
              <div class="metric-group align-right small-legend">
                <span class="legend legend-clip"></span>
                <span class="small-label">CLIP</span>
                <span class="spacer"></span>
                <span class="legend legend-dino"></span>
                <span class="small-label">DINO</span>
              </div>
            </div>
            <div id="plot-rot" class="plot"></div>
          </div>
        </section>

        <section id="sec-color" class="content-section">
          <div class="viewer viewer-slim">
            <div class="metrics-row">
              <div class="selector-group">
                <label for="modelSelect-color" class="muted small-label">Color</label>
                <select id="modelSelect-color" aria-label="Color selector"></select>
              </div>
              <div class="metric-group align-right">
                <span class="muted small-label">CLIP</span>
                <span id="clipValue-color" class="metric metric-clip">—</span>
                <span class="spacer"></span>
                <span class="muted small-label">DINO</span>
                <span id="dinoValue-color" class="metric metric-dino">—</span>
              </div>
            </div>
          </div>

          <div class="viewers" style="overflow: hidden;">
            <div class="viewer">
              <div class="image-frame">
                <img id="img-color-1" alt="Color View 1" loading="lazy" />
              </div>
              <div class="slider-row">
                <input id="slider-color-1" type="range" min="0" max="0" step="1" value="0"
                  aria-label="Color index slider 1" />
                <div class="angle-label" id="angle-color-1">0</div>
              </div>
            </div>

            <div class="viewer">
              <div class="image-frame">
                <img id="img-color-2" alt="Color View 2" loading="lazy" />
              </div>
              <div class="slider-row">
                <input id="slider-color-2" type="range" min="0" max="0" step="1" value="0"
                  aria-label="Color index slider 2" />
                <div class="angle-label" id="angle-color-2">0</div>
              </div>
            </div>
          </div>
          <div class="viewer plot-card">
            <div class="metrics-row">
              <div class="selector-group">
                <span class="small-label muted">Similarity vs color</span>
              </div>
              <div class="metric-group align-right small-legend">
                <span class="legend legend-clip"></span>
                <span class="small-label">CLIP</span>
                <span class="spacer"></span>
                <span class="legend legend-dino"></span>
                <span class="small-label">DINO</span>
              </div>
            </div>
            <div id="plot-color" class="plot"></div>
          </div>
        </section>

        <section id="sec-subj" class="content-section">
          <div class="viewer viewer-slim">
            <div class="metrics-row">
              <div class="selector-group">
                <label for="modelSelect-subj" class="muted small-label">Subject</label>
                <select id="modelSelect-subj" aria-label="Subject selector"></select>
              </div>
              <div class="metric-group align-right">
                <span class="muted small-label">CLIP</span>
                <span id="clipValue-subj" class="metric metric-clip">—</span>
                <span class="spacer"></span>
                <span class="muted small-label">DINO</span>
                <span id="dinoValue-subj" class="metric metric-dino">—</span>
              </div>
            </div>
          </div>

          <div class="viewers" style="overflow: hidden;">
            <div class="viewer">
              <div class="image-frame">
                <img id="img-subj-1" alt="Subject View 1" loading="lazy" />
              </div>
              <div class="slider-row">
                <input id="slider-subj-1" type="range" min="0" max="0" step="1" value="0"
                  aria-label="Subject index slider 1" />
                <div class="angle-label" id="angle-subj-1">0</div>
              </div>
            </div>

            <div class="viewer">
              <div class="image-frame">
                <img id="img-subj-2" alt="Subject View 2" loading="lazy" />
              </div>
              <div class="slider-row">
                <input id="slider-subj-2" type="range" min="0" max="0" step="1" value="0"
                  aria-label="Subject index slider 2" />
                <div class="angle-label" id="angle-subj-2">0</div>
              </div>
            </div>
          </div>
          <div class="viewer plot-card">
            <div class="metrics-row">
              <div class="selector-group">
                <span class="small-label muted">Similarity vs index</span>
              </div>
              <div class="metric-group align-right small-legend">
                <span class="legend legend-clip"></span>
                <span class="small-label">CLIP</span>
                <span class="spacer"></span>
                <span class="legend legend-dino"></span>
                <span class="small-label">DINO</span>
              </div>
            </div>
            <div id="plot-subj" class="plot"></div>
          </div>
        </section>
        <section id="sec-dewey" class="content-section">
          <div class="viewer viewer-slim">
            <div class="metrics-row">
              <div class="selector-group">
                <span id="dewey-header-label" class="muted small-label">Dewey Decimal System</span>
              </div>
            </div>
          </div>
          <div class="viewer plot-card">
            <div id="chart-dewey" class="dewey-chart"></div>
          </div>
        </section>
      </div>
    </div>

    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="script.js"></script>
</body>

</html>