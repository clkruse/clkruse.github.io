<!doctype html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-105607174-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-105607174-2');
    </script>
    <title>Caleb Kruse - Running</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- css. Last sheet takes priority -->
    <link rel="stylesheet" href="./css/style-v2.css">
    <link rel="stylesheet" href="./css/header-backgrounds.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
</head>

<body>

    <header class="run-header">
        <div class="container-fluid menu">
            <div class="d-flex justify-content-end">
                <a href="/">
                    <button class="button-black">home</button>
                </a>
            </div>
        </div>
    </header>



    <div class="container">
        <div class="row justify-content-center">
            <div class="col-10 text-center">
                <h5 class="small-heading">running</h5>
                <h3 class="page-heading mb-0">
                    i like to run far and mostly in the mountains
                </h3>
            </div>
        </div>
    </div>

    <!-- <div class="container">
        <div class="row justify-content-center mb-3">
            <div class="col-md-5 col-sm-12">
                <iframe height='454' width='100%' frameborder='0' allowtransparency='true' scrolling='no'
                    src='https://www.strava.com/athletes/155470/latest-rides/cfa36ece31a9faa6fd429ab35f27060fca1521f0'></iframe>
            </div>
        </div>
    </div> -->

    <div class="container-fluid card-container">
        <div class="row justify-content-center">

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <h5 id="miles_per_year_title" style="font-weight: bold"></b>number of miles per year</b></h5>
                <div id="miles_per_year"></div>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <h5 id="hours_per_year_title" style="font-weight: bold"></b>number of hours per year</b></h5>
                <div id="hours_per_year"></div>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <h5 id="elevation_per_year_title" style="font-weight: bold"></b>elevation climbed per year</b></h5>
                <div id="elevation_per_year"></div>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <h5 id="avg_length_per_year_title" style="font-weight: bold"></b>average run length</b></h5>
                <div id="avg_length_per_year"></div>
            </div>

            <div class="col-10 text-center">
                <h1 class="content-card mb-0"><b>races</b></h1>
                <h3 class="content-card mb-0">marathon distance or longer</h3>
                <p class="page-heading card-text" style="padding-top: 0">Some of these are
                    unofficial, as I had a habit of banditing races for a time ðŸ‘€
                </p>
            </div>
            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/13698965647">
                    <img class="card-image" src="./img/marathon-photos/salmon-2025.jpg">
                    <h3 class="card-title">salmon falls 50k - 2025</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:32:44 - 4th male, 5th overall</h5>
            </div>
            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/13075185205">
                    <img class="card-image" src="./img/marathon-photos/cim-2024.jpg">
                    <h3 class="card-title">california international marathon - 2024</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 2:56:06</h5>
            </div>
            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/10829600199">
                    <img class="card-image" src="./img/marathon-photos/salmon-2024.jpg">
                    <h3 class="card-title">salmon falls 50k - 2024</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:50:19 - 6th</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/10242057115">
                    <img class="card-image" src="./img/marathon-photos/jfk-2023-2.jpg">
                    <h3 class="card-title">jfk 50 - 2023</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 8:11:23</h5>
            </div>
            
            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/9871286550">
                    <img class="card-image" src="./img/marathon-photos/ppm-2023.jpg">
                    <h3 class="card-title">pikes peak marathon - 2023</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 5:54:57</h5>
            </div>
            
            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/9335899365">
                    <img class="card-image" src="./img/marathon-photos/wser-2023.jpg">
                    <h3 class="card-title">western states 100 miler - 2023</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 23:40:29</h5>
            </div>
            
            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/8208149770">
                    <img class="card-image" src="./img/marathon-photos/cim-2022.jpg">
                    <h3 class="card-title">california international marathon - 2022</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 2:59:53</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/8208149770">
                    <img class="card-image" src="./img/marathon-photos/mcm-2022.jpg">
                    <h3 class="card-title">marine corps marathon - 2022</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 3:11:55</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/7830138983">
                    <img class="card-image" src="./img/marathon-photos/ppm-2022.jpg">
                    <h3 class="card-title">pikes peak marathon - 2022</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 5:59:25</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/7105651899">
                    <img class="card-image" src="./img/marathon-photos/miwok-2022.jpg">
                    <h3 class="card-title">miwok 100k - 2022</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 12:45:44</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/6314804168">
                    <img class="card-image" src="./img/marathon-photos/quad-dipsea-2021.jpg">
                    <h3 class="card-title">quad dipsea - 2021</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:50:08 - 10th</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/6055514745">
                    <img class="card-image" src="./img/marathon-photos/cuyamaca-2021.jpg">
                    <h3 class="card-title">cuyamaca 100k - 2021</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 13:17:58 - 19th</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/5836452420">
                    <img class="card-image" src="./img/marathon-photos/ppm-2021.jpg">
                    <h3 class="card-title">pikes peak marathon - 2021</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 5:18:38 - 53rd</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/3957020808">
                    <img class="card-image" src="./img/marathon-photos/ppm-2020.jpg">
                    <h3 class="card-title">pikes peak marathon - 2020</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 7:29:03</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/2651819667">
                    <img class="card-image" src="./img/marathon-photos/ppm-2019.jpg">
                    <h3 class="card-title">pikes peak marathon - 2019</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 5:52:18</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/1784362013">
                    <img class="card-image" src="./img/marathon-photos/ppm-2018.jpg">
                    <h3 class="card-title">pikes peak marathon - 2018</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 5:57:29</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/1472143934">
                    <img class="card-image" src="./img/marathon-photos/oakland-2018.jpg">
                    <h3 class="card-title">oakland marathon - 2018</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:07:36</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://calendar.ultrarunning.com/runner/show?first_name=Caleb&last_name=Kruse">
                    <img class="card-image" src="./img/marathon-photos/tnf-50.jpg">
                    <h3 class="card-title">50-miler: north face endurance challenge california - 2017</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 12:03:45</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/1143983595">
                    <img class="card-image" src="./img/marathon-photos/ppm-2017.jpg">
                    <h3 class="card-title">pikes peak marathon - 2017</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 6:20:19</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/965463022">
                    <img class="card-image" src="./img/marathon-photos/bsim-2017-.jpg">
                    <h3 class="card-title">big sur marathon - 2017</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 3:54:20</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/717251834">
                    <img class="card-image" src="./img/marathon-photos/hmb-2016.jpg">
                    <h3 class="card-title">half moon bay marathon - 2016</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:17:13</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/354746500">
                    <img class="card-image" src="./img/marathon-photos/sf-2015.jpg">
                    <h3 class="card-title">san francisco marathon - 2015</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:06:38</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/135014698">
                    <img class="card-image" src="./img/marathon-photos/bsim-2014.jpg">
                    <h3 class="card-title">big sur marathon - 2014</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:31:58</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/99141549">
                    <img class="card-image" src="./img/marathon-photos/tnf-2013.jpg">
                    <h3 class="card-title">north face endurance challenge california marathon - 2013</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:46:00</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/51310420">
                    <img class="card-image" src="./img/marathon-photos/bsim-2013.jpg">
                    <h3 class="card-title">big sur marathon - 2013</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:27:33</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/23569705">
                    <img class="card-image" src="./img/marathon-photos/berlin-2012.jpg">
                    <h3 class="card-title">berlin marathon - 2012</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:26:50</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.strava.com/activities/23569705">
                    <img class="card-image" src="./img/marathon-photos/ppm-2010.jpg">
                    <h3 class="card-title">pikes peak marathon - 2010</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 6:48:09</h5>
            </div>

            <div class="col-lg-5 col-md-9 col-xs-12 content-card">
                <a class="mb-0" href="https://www.bigsurmarathon.org/wp-content/uploads/2019/06/Results-Book.pdf">
                    <img class="card-image" src="./img/marathon-photos/bsim-2010.jpg">
                    <h3 class="card-title">big sur marathon - 2010</h3>
                </a>
                <h5 class="card-title mt-0" style="padding-top: 0">time - 4:43:17</h5>
            </div>
        </div>
    </div>

    </div>

    <footer id="footer" class="footer">
        <div class="row align-items-center">
            <div class="col-xs-12 col-6">
                <div class="footer-socials text-left">
                    <a href="https://twitter.com/clkruse" target="_blank">
                        <i class="fa fa-twitter"></i>
                    </a>
                    <a href="https://www.instagram.com/clkruse" target="_blank">
                        <i class="fa fa-instagram"></i>
                    </a>
                </div>
            </div>
            <div class="col-xs-12 col-6">
                <p class="copyright">Â© Caleb Kruse</p>
            </div>
        </div>
    </footer>


    <script src="https://d3js.org/d3.v4.js"></script>

    <script>
        // Configuration object for graphs
        const graphConfig = {
            margin: { top: 30, right: 30, bottom: 70, left: 60 },
            barColor: "#7aa3d9",
            hoverColor: "#bdd9ff",
            strokeColor: "black",
            strokeWidth: 0.5,
            height: 360 // Base height for all graphs
        };

        // Graph specifications
        const graphs = [
            {
                id: "miles_per_year",
                title: "number of miles per year",
                yAxisLabel: "Miles",
                valueKey: "Miles",
                yDomain: [0, 2250],
                extrapolate: true,
                getValue: d => d.Miles
            },
            {
                id: "hours_per_year",
                title: "number of hours per year",
                yAxisLabel: "Hours",
                valueKey: "Hours",
                yDomain: [0, 400],
                extrapolate: true,
                getValue: d => d.Hours
            },
            {
                id: "elevation_per_year",
                title: "elevation climbed per year",
                yAxisLabel: "Feet",
                valueKey: "Elevation",
                yDomain: [0, 310000],
                extrapolate: true,
                getValue: d => d.Elevation
            },
            {
                id: "avg_length_per_year",
                title: "average run length",
                yAxisLabel: "Miles",
                yDomain: [0, 12],
                extrapolate: false,
                getValue: d => d.Miles / d.Runs,
                formatValue: val => val.toPrecision(2)
            }
        ];

        // Calculate year completion percentage
        function getYearProgress() {
            const currentDate = new Date();
            const currentYear = currentDate.getFullYear();
            const daysInYear = currentYear % 4 === 0 ? 366 : 365;
            const daysElapsed = Math.floor((currentDate - new Date(currentYear, 0, 0)) / (1000 * 60 * 60 * 24));
            return daysElapsed / daysInYear;
        }

        // Get dimensions for a graph
        function getDimensions(containerId) {
            const containerWidth = document.getElementById(containerId).offsetWidth;
            return {
                width: containerWidth - graphConfig.margin.left - graphConfig.margin.right,
                height: graphConfig.height - graphConfig.margin.top - graphConfig.margin.bottom
            };
        }

        // Create base SVG for a graph
        function createBaseSVG(containerId, dimensions) {
            const container = document.getElementById(containerId);
            // Clear any existing SVG
            container.innerHTML = '';
            
            return d3.select(`#${containerId}`)
                .append("svg")
                .attr("width", dimensions.width + graphConfig.margin.left + graphConfig.margin.right)
                .attr("height", dimensions.height + graphConfig.margin.top + graphConfig.margin.bottom)
                .append("g")
                .attr("transform", `translate(${graphConfig.margin.left},${graphConfig.margin.top})`);
        }

        // Create scales for a graph
        function createScales(data, graphSpec, dimensions) {
            const x = d3.scaleBand()
                .range([0, dimensions.width])
                .domain(data.map(d => d.Year))
                .padding(0.2);

            const y = d3.scaleLinear()
                .domain(graphSpec.yDomain)
                .nice()
                .range([dimensions.height, 0]);

            return { x, y };
        }

        // Add axes to graph
        function addAxes(svg, scales, dimensions, yAxisLabel) {
            // X axis
            svg.append("g")
                .attr("transform", `translate(0,${dimensions.height})`)
                .call(d3.axisBottom(scales.x))
                .selectAll("text")
                .attr("transform", "translate(-10,0)rotate(-45)")
                .style("text-anchor", "end");

            // Y axis
            svg.append("g")
                .call(d3.axisLeft(scales.y));

            // Y axis label
            svg.append('text')
                .text(yAxisLabel)
                .attr('transform', 'translate(-43, -15)');
        }

        // Add bars to graph
        function addBars(svg, data, scales, graphSpec, dimensions) {
            svg.selectAll("rect")
                .data(data)
                .enter()
                .append("rect")
                .attr("x", d => scales.x(d.Year))
                .attr("y", d => scales.y(graphSpec.getValue(d)))
                .attr("width", scales.x.bandwidth())
                .attr("height", d => dimensions.height - scales.y(graphSpec.getValue(d)))
                .attr("fill", d => d.Year.endsWith('*') ? graphConfig.hoverColor : graphConfig.barColor)
                .attr("stroke", graphConfig.strokeColor)
                .attr("stroke-width", graphConfig.strokeWidth)
                .on("mouseenter", function(d) {
                    const value = graphSpec.getValue(d);
                    const displayValue = graphSpec.formatValue ? graphSpec.formatValue(value) : value;
                    d3.select(this).attr("fill", graphConfig.hoverColor);
                    d3.select(`#${graphSpec.id}_title`)
                    .text(`${displayValue} ${graphSpec.yAxisLabel} \ in ${d.Year}`.toLowerCase())

                })
                .on("mouseleave", function(d) {
                    d3.select(this).attr("fill", graphConfig.barColor);
                    d3.select(`#${graphSpec.id}_title`).text(graphSpec.title);
                });
        }

        // Main function to create a graph
        function createGraph(graphSpec, data) {
            const dimensions = getDimensions(graphSpec.id);

            // Handle data extrapolation for current year if needed
            let graphData = [...data];
            if (graphSpec.extrapolate) {
                const yearProgress = getYearProgress();
                const currentYear = new Date().getFullYear();
                const currentYearData = data.find(d => d.Year == currentYear);
                
                if (currentYearData) {
                    const extrapolatedValue = Math.round(graphSpec.getValue(currentYearData) * (1 / yearProgress));
                    const extrapolatedData = {
                        Year: currentYear.toString() + ' - forecast',
                        [graphSpec.valueKey]: extrapolatedValue
                    };
                    graphData.push(extrapolatedData);
                }
            }

            const svg = createBaseSVG(graphSpec.id, dimensions);
            const scales = createScales(graphData, graphSpec, dimensions);
            addAxes(svg, scales, dimensions, graphSpec.yAxisLabel);
            addBars(svg, graphData, scales, graphSpec, dimensions);
        }

        // Initialize all graphs when data is loaded
        d3.csv("running_yearly_stats.csv", function(data) {
            graphs.forEach(graphSpec => createGraph(graphSpec, data));

            // Add window resize handler
            window.addEventListener('resize', () => {
                graphs.forEach(graphSpec => createGraph(graphSpec, data));
            });
        });
    </script>
</body>
</html>